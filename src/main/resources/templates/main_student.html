<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="ThemeBucket">
    <link rel="shortcut icon" href="#" type="image/png">
    <title th:inline="text">学生首页 - [[${session.loginUser.name}]]</title>
    <link th:replace="common::common_header">

<body class="horizontal-menu-page unselectable">

<section>

    <nav class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">
                    <img src="images/logo.png" alt="">
                </a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a th:href="@{/mainStudent}">Dashboard</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <!--<img alt="" src="images/photos/user-avatar.png">-->
                            <span th:inline="text">[[${session.loginUser.name}]]</span>
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <!--<li><a href="#">Profile</a></li>-->
                            <li><a th:href="@{/changePasswd(id=${session.loginUser.sno})}">修改密码</a></li>
                            <li><a th:href="@{/logout}">退出登录</a></li>
                        </ul>
                    </li>
                </ul>
            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>

    <div class="page-heading">
        <h3><em>我的实验</em></h3>
    </div>

    <div class="panel" style="background-color:#F0F0F0">
        <!--body wrapper start-->
        <div class="wrapper">
            <div class="col col-sm-12">
                <div class="panel">
                    <div class="panel-body">
                        Filter Here...
                    </div>
                </div>
            </div>
            <div class="col col-sm-5">
                <div th:if="${unsubmitted.size() != 0}">
                    <section class="panel">
                        <header class="panel-heading">
                            <span>未提交实验报告</span>
                            <span class="tools pull-right">
                                <a href="javascript:" class="fa fa-chevron-down"></a>
                                <!--                                <a href="javascript:" class="fa fa-times"></a>-->
                            </span>
                        </header>
                        <div class="panel-body">
                            <div class="adv-table editable-table ">
                                <div class="space15"></div>
                                <table class="table table-striped table-hover table-bordered"
                                       style="vertical-align: center" id="editable-sample1">
                                    <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>实验</th>
                                        <th>课程名</th>
                                        <th>截止日期</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr class="gradeX" th:each="template, stat:${unsubmitted}">
                                        <td th:text="${stat.count}">Trident</td>
                                        <td>
                                            <a th:href="@{/downloadTemplate(id=${template.templateId})}">
                                                <span th:text="${template.name}"></span>
                                            </a>
                                        </td>
                                        <td th:text="${template.courseId}"></td>
                                        <td th:text="${#dates.format(template.deadline,'yyyy-MM-dd HH:mm')}"></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1"
                                 id="uploadNewReport"
                                 class="modal fade" style="display: none;">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button aria-hidden="true" data-dismiss="modal" class="close" type="button">
                                                ×
                                            </button>
                                            <h4 class="modal-title">上传实验报告</h4>
                                        </div>
                                        <!--上传表单-->
                                        <div class="modal-body">
                                            <form role="form" th:action="@{/uploadReport(sno=${session.loginUser.sno})}"
                                                  method="post"
                                                  enctype="multipart/form-data">
                                                <div class="form_item">
                                                    <label>
                                                        <label for="file">实验文件:</label><br/>
                                                        <input type="file" id="file" name="file" accept=".pdf">
                                                    </label>
                                                </div>
                                                <div class="form_item">
                                                    <label for="template">实验名:</label>
                                                    <select id="template" name="templateId"
                                                            class="form-control m-bot15">
                                                        <option th:each="template, stat:${unsubmitted}"
                                                                th:text="${template.name}"
                                                                th:value="${template.templateId}">
                                                        </option>
                                                    </select>
                                                </div>
                                                <br/><br/>
                                                <button type="submit" class="btn btn-primary">提交</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="panel-footer">
                            <div>
                                <a href="#uploadNewReport" data-toggle="modal" class="btn btn-default">
                                    <i class="fa fa-upload"></i> 上传实验报告
                                </a>
                                <span th:if="${message != null}">
                                    <span th:text="${message}" class="fa fa-warning" style="color: red"></span>
                                </span>
                            </div>
                        </div>

                    </section>
                </div>
                <div th:if="${unsubmitted.size() == 0}">
                    <section class="panel">
                        <header class="panel-heading">
                            <span>你已提交所有实验报告!</span>
                            <span class="tools pull-right">
<!--                                <a href="javascript:" class="fa fa-times"></a>-->
                            </span>
                        </header>
                    </section>
                </div>
            </div>
            <div class="col col-sm-7">
                <div th:if="${submitted.size() != 0}">
                    <section class="panel">
                        <header class="panel-heading">
                            <span>已提交的实验报告</span>
                            <span class="tools pull-right">
                                <a href="javascript:" class="fa fa-chevron-down"></a>
                                <!--                                <a href="javascript:" class="fa fa-times"></a>-->
                            </span>
                        </header>
                        <div class="panel-body">
                            <div class="adv-table editable-table ">
                                <div class="space15"></div>
                                <table class="table table-striped table-hover table-bordered" id="editable-sample">
                                    <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>实验</th>
                                        <th>课程名</th>
                                        <th>截止日期</th>
                                        <th>提交日期</th>
                                        <th>状态</th>
                                        <th>操作
                                            <i data-original-title="下载实验 | 删除实验" type="button"
                                               class="fa fa-question-circle tooltips" data-toggle="tooltip"
                                               data-placement="top">
                                            </i>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr class="gradeX" th:each="entry, stat:${submitted}">
                                        <td th:text="${stat.count}">Trident</td>
                                        <td>
                                            <a th:href="@{/downloadTemplate(id=${entry.key.templateId})}">
                                                <span th:text="${entry.key.name}"></span>
                                            </a>
                                            <div th:if="${success != null && entry.key.templateId == messageId}">
                                                <span th:text="${success}" class="fa fa-check-circle-o"
                                                      style="color: #4169E1"></span>
                                            </div>
                                            <div th:if="${message != null && entry.key.templateId == messageId}">
                                                <span th:text="${message}" class="fa fa-check-circle-o"
                                                      style="color: red"></span>
                                            </div>
                                        </td>
                                        <td th:text="${entry.key.courseId}"></td>
                                        <td th:text="${#dates.format(entry.key.deadline,'yyyy-MM-dd HH:mm')}"></td>
                                        <td th:text="${#dates.format(entry.value.uploadTime,'yyyy-MM-dd HH:mm')}">
                                            Trident
                                        </td>
                                        <td th:if="${entry.value.status}">
                                            <span class="label label-success label-mini">按时</span>
                                        </td>
                                        <td th:if="${!entry.value.status}">
                                            <span class="label label-danger label-mini">迟交</span>
                                        </td>
                                        <td class="unselectable">
                                            <a th:href="@{/downloadReport(reportId=${entry.value.rid})}">
                                                <span class="fa fa-download"></span></a>
                                            <span>&nbsp;|&nbsp;</span>
                                            <a th:href="@{/deleteReport(reportId=${entry.value.rid})}">
                                                <span class="fa fa-trash-o"></span></a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </section>
                </div>
                <div th:if="${submitted.size() == 0}">
                    <section class="panel">
                        <header class="panel-heading">
                            <span>你还未提交任何实验报告!</span>
                            <span class="tools pull-right">
<!--                                <a href="javascript:" class="fa fa-times"></a>-->
                            </span>
                        </header>
                    </section>
                </div>
            </div>
        </div>
        <!--body wrapper end-->
    </div>

    <!--footer section start-->
    <footer class="sticky-footer">
        Footer contents goes here
    </footer>
    <!--footer section end-->

</section>

<!-- Placed js at the end of the document so the pages load faster -->
<div th:replace="common::#common_script"></div>

<!--script for editable table-->
<script th:src="@{/js/editable-table.js}"></script>

</body>
</html>
