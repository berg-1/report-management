<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="ThemeBucket">
    <title>修改密码</title>
    <link th:replace="common::common_header">
</head>
<body class="login-body unselectable">

<div class="container login-container">

    <form class="form-signin" th:action="@{/updatePasswd}" method="post">
        <div class="glass glass-login">
            <div class="form-signin-heading text-center">
                <h1 class="login-title">Reset PW</h1>
            </div>
            <div class="login-wrap">
                <div th:if="${msg != null}" style="line-height: 10px">
                    <label class="error" th:text="${msg}"></label>
                </div>
                <div th:if="${success != null}" style="line-height: 10px">
                    <label style="color:#4169E1;" th:text="${success}"></label>
                </div>
                <div class="glass input-wrap">
                    <label for="username"></label>
                    <div class="input-label material-icons-outlined" onclick="location.href='#username';">
                        account_circle
                    </div>
                    <input id="username" type="text" name="userId" class="input-content" placeholder="用户名"
                           autofocus required th:value="${id}">
                </div>
                <div class="glass input-wrap">
                    <label for="passwd"></label>
                    <div class="input-label material-icons-outlined" onclick="location.href='#passwd';">
                        pin
                    </div>
                    <input id="passwd" type="password" name="passwd" class="input-content" placeholder="原密码">
                </div>
                <div class="glass input-wrap">
                    <label for="passwd_new"></label>
                    <div class="input-label material-icons-outlined" onclick="location.href='#passwd_new';">
                        restart_alt
                    </div>
                    <input id="passwd_new" type="password" name="passwdNew" class="input-content" placeholder="新密码"
                           onkeyup="validate()">
                </div>
                <div class="glass input-wrap">
                    <label for="passwd_retry"></label>
                    <div class="input-label material-icons-outlined" onclick="location.href='#passwd_retry';">
                        restart_alt
                    </div>
                    <input id="passwd_retry" type="password" name="passwd_retry" class="input-content"
                           placeholder="重新输入密码" onkeyup="validate()">
                </div>
                <span id="notice"></span>
                <button type="submit" class="btn btn-lg btn-login btn-block" id="submit">
                    <i class="fa fa-check"></i>
                </button>
                <div class="registration">
                    Already Registered.
                    <a th:href="@{/login}" class="">
                        Login
                    </a>
                </div>
            </div>
        </div>
    </form>
</div>

<!--footer content start-->
<div class="container">
    <div class="form-signin" style="max-width: 150px; margin: auto;">
        <div class="glass glass-version">
            <label> Version <span th:text="#{version}"></span></label>
        </div>
    </div>
</div>
<!--footer content ends-->

<script>
    function validate() {
        const pwd1 = document.getElementById("passwd_new").value;
        const pwd2 = document.getElementById("passwd_retry").value;
        <!-- 对比两次输入的密码 -->
        if (pwd1 === pwd2) {
            document.getElementById("notice").innerHTML = "<span class='fa fa-check-circle-o' style='color: #4169E1'> 密码相同</span>";
            document.getElementById("submit").disabled = false;
        } else {
            document.getElementById("notice").innerHTML = "<span style='color: red'>请输入相同的密码</span>";
            document.getElementById("submit").disabled = true;
        }
    }
</script>

<!-- Placed js at the end of the document so the pages load faster -->
<div th:replace="common::#common_script"></div>

<!--script for editable table-->
<script th:src="@{/js/editable-table.js}"></script>

</body>
</html>